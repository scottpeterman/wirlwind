# BGP Summary - Cisco IOS / IOS-XE
#
# Actual output:
#   Neighbor        V           AS MsgRcvd MsgSent   TblVer  InQ OutQ Up/Down  State/PfxRcd
#   172.16.1.1      4        65002    4521    4518       15    0    0 3d02h           5
#   10.0.0.1        4        65004       0       0        1    0    0 never    Idle

command: "show ip bgp summary"
interval: 60

parsers:
  - type: textfsm
    templates:
      - cisco_ios_show_ip_bgp_summary.textfsm

  - type: regex
    pattern: '^([\d.]+)\s+4\s+(\d+)\s+\d+\s+\d+\s+\d+\s+\d+\s+\d+\s+(\S+)\s+(\S+)\s*$'
    flags: MULTILINE
    groups:
      neighbor: 1
      remote_as: 2
      updown: 3
      state_pfx: 4

normalize:
  neighbor: neighbor
  remote_as: remote_as
  uptime: updown
  state_pfx: state_pfx
