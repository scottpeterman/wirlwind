# Log collection - Arista EOS
#
# No NTC TextFSM template exists for Arista EOS show logging.
# Uses regex parsing only.
#
# Actual output format:
#   Feb 15 18:21:37 switch Ebra: %LINEPROTO-5-UPDOWN: Line protocol on Interface Ethernet1, changed state to up
#   Feb 15 18:21:37 switch Stp: %SPANTREE-6-INTERFACE_ADD: Interface Ethernet1 added to instance 1
#   Feb 15 18:30:01 switch ConfigAgent[1234]: %SYS-5-CONFIG_I: Configured from console
#
# The format is: <timestamp> <hostname> <process>: %<facility>-<severity>-<mnemonic>: <message>
#
# Using "show logging last 50" to get recent entries without the logging config preamble.

command: "show logging last 50 hours 245"
interval: 30

parsers:
  # Regex: capture syslog entries
  # Matches: "Feb 15 18:21:37 hostname Process: %FACILITY-SEV-MNEMONIC: message"
  - type: regex
    pattern: '^(\w+\s+\d+\s+[\d:]+)\s+\S+\s+\S+:\s+%(\w+)-(\d+)-(\w+):\s*(.*?)$'
    flags: MULTILINE
    groups:
      timestamp: 1
      facility: 2
      severity: 3
      mnemonic: 4
      message: 5
