# Cisco IOS-XE LLDP neighbors template
# Parses: show lldp neighbors
# Produces: neighbor list with local/remote port mapping

command: "show lldp neighbors"
interval: 300

patterns:
  neighbors:
    type: table
    # Device ID  Local Intf  Hold-time  Capability  Port ID
    pattern: '^(\S+)\s+((?:Gi|Te|Tw|Hu|Fo|Eth|mgmt)\S+)\s+\d+\s+\S+\s+(\S+)\s*$'
    flags: MULTILINE
    groups:
      device_id: 1
      local_intf: 2
      remote_port: 3
    types:
      device_id: str
      local_intf: str
      remote_port: str
