# Cisco IOS-XE environment sensors template
# Parses: show environment all
# Produces: temperature, fan, and PSU status
# Note: Output varies significantly by platform â€” adjust patterns as needed

command: "show environment all"
interval: 120

patterns:
  temperatures:
    type: table
    pattern: '(\S[\S ]*?)\s+(Normal|Warning|Critical|Not Present)\s+(\d+)\s+Celsius'
    groups:
      sensor: 1
      state: 2
      temp_c: 3
    types:
      sensor: str
      state: str
      temp_c: int

  fans:
    type: table
    pattern: '(Fan\s*\S*|FAN[\s-]*\S*)\s+(\d+)\s+'
    flags: IGNORECASE
    groups:
      fan_id: 1
      speed_rpm: 2
    types:
      fan_id: str
      speed_rpm: int

  power:
    type: table
    pattern: '(PS\d+|PWR-\S+|Power Supply\s*\d+)\s+\S+\s+\S+\s+(Ok|Normal|Not Present|Fail)'
    flags: IGNORECASE
    groups:
      psu_id: 1
      status: 2
    types:
      psu_id: str
      status: str
