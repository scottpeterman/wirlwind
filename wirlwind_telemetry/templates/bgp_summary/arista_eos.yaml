# Arista EOS BGP summary template
# Parses: show ip bgp summary
# Very similar to IOS-XE output

command: "show ip bgp summary"
interval: 60

patterns:
  identity:
    pattern: 'BGP router identifier\s+([\d.]+),\s+local AS number\s+(\d+)'
    groups:
      router_id: 1
      local_as: 2
    types:
      router_id: str
      local_as: int

  peers:
    type: table
    pattern: '^([\d.]+)\s+4\s+(\d+)\s+(\d+)\s+(\d+)\s+\d+\s+\d+\s+\d+\s+(\S+)\s+(\S+)\s*$'
    flags: MULTILINE
    groups:
      neighbor: 1
      remote_as: 2
      msg_rcvd: 3
      msg_sent: 4
      updown: 5
      state_pfx: 6
    types:
      neighbor: str
      remote_as: int
      msg_rcvd: int
      msg_sent: int
      updown: str
      state_pfx: str
